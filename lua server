-- Roblox ServerScript: Polls claim API and rewards player in-game

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")

local API_URL = "https://your-vercel-site.vercel.app/api/claim"

-- Simple in-memory check to avoid double-rewarding
local claimed = {}

-- Poll for claims every 10s for each player
function checkClaim(player)
    if claimed[player.UserId] then return end
    local username = player.Name
    local url = API_URL .. "?username=" .. HttpService:UrlEncode(username)
    local success, response = pcall(function()
        return HttpService:GetAsync(url)
    end)
    if not success then
        warn("Claim check failed for", username)
        return
    end
    local data = HttpService:JSONDecode(response)
    if data and data.success and data.item then
        claimed[player.UserId] = true
        -- Reward logic (customize as needed)
        print(username .. " claimed: " .. data.item)
        -- For example, give item:
        -- GivePlayerItem(player, data.item)
        player:Kick("Congrats! You claimed: " .. data.item)
    end
end

Players.PlayerAdded:Connect(function(player)
    while player.Parent do
        checkClaim(player)
        wait(10)
    end
end)
